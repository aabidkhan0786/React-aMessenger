(this.webpackJsonpamessenger=this.webpackJsonpamessenger||[]).push([[0],{104:function(e,t,a){},159:function(e,t,a){e.exports=a(233)},231:function(e,t,a){},233:function(e,t,a){"use strict";a.r(t);var n,r=a(0),c=a.n(r),l=a(73),s=a.n(l),o=(a(164),a(12)),u=a(37),i=a(14),m=a.n(i),d=a(31),p=a(17),f=a.n(p),b=(a(104),a(150)),E=a.n(b),h=function(){var e=Object(o.c)((function(e){return e.auth})),t=Object(o.b)();return c.a.createElement(c.a.Fragment,null,c.a.createElement("nav",{className:"navbar navbar-expand-lg menu container-fluid sticky-top",style:{backgroundColor:"black"}},c.a.createElement("p",{className:"neon"},"aMessenger"),e.authenticated?c.a.createElement(c.a.Fragment,null,c.a.createElement(u.b,{className:"nav-link ml-auto logout",to:"#",onClick:function(a){return t((n=e.uid,function(){var e=Object(d.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t({type:"USER_LOGOUT_REQUEST"}),Object(p.firestore)().collection("users").doc(n).update({isOnline:!1}).then((function(){Object(p.auth)().signOut().then((function(){localStorage.clear(),t({type:"USER_LOGOUT_SUCCESS"})})).catch((function(e){console.log(e),t({type:"USER_LOGOUT_FAIL",payload:{error:e}})}))})).catch((function(e){console.log(e),alert(e)}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));var n}},"LogOut ",c.a.createElement(E.a,null))):null))},O=a(5),g=a(23),v=a(8),S=a(101),j=a(151),y=a.n(j),N=(a(198),a(199),a(155)),_=a.n(N),w=a(154),U=a.n(w),k=function(e){var t=e.user,a=e.onClick,n="".concat(t.firstName," ").concat(t.lastName);return console.log(n),c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"carousel",onClick:function(){return a(t)}},t.isOnline?c.a.createElement("span",{className:"float-right online"},"  "):c.a.createElement("span",{className:"float-right  offline"},"  "),c.a.createElement(S.a,{size:"40",round:!0,name:n})," ",n))},C=function(){var e=Object(o.b)(),t=Object(o.c)((function(e){return e.auth})),a=Object(o.c)((function(e){return e.user})),n=Object(r.useState)(!1),l=Object(g.a)(n,2),s=l[0],u=l[1],i=Object(r.useState)(""),f=Object(g.a)(i,2),b=f[0],E=f[1],h=Object(r.useState)(""),O=Object(g.a)(h,2),j=O[0],N=O[1],w=Object(r.useState)(null),C=Object(g.a)(w,2),I=C[0],L=C[1];Object(r.useEffect)((function(){var a;e((a=t.uid,function(){var e=Object(d.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t({type:"USER_REQUEST"}),Object(p.firestore)().collection("users").onSnapshot((function(e){var n=[];e.forEach((function(e){e.data().uid!=a&&n.push(e.data())})),t({type:"USER_SUCCESS",payload:{users:n}})}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()))}),[]);var x=function(a){var n="".concat(a.firstName," ").concat(a.lastName);u(!0),E(n),L(a.uid),e(function(e){return function(){var t=Object(d.a)(m.a.mark((function t(a){return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:Object(p.firestore)().collection("conversations").where("user_uid_1","in",[e.uid_1,e.uid_2]).orderBy("createdAt","asc").onSnapshot((function(t){var n=[];t.forEach((function(t){console.log(t.data()),(t.data().user_uid_1==e.uid_1&&t.data().user_uid_2==e.uid_2||t.data().user_uid_1==e.uid_2&&t.data().user_uid_2==e.uid_1)&&n.push(t.data())})),a({type:"MESSAGE_SENT_SUCCESS",payload:{conversations:n}}),console.log(n)}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}({uid_1:t.uid,uid_2:a.uid}))};return c.a.createElement(c.a.Fragment,null,c.a.createElement("section",{className:"row "},c.a.createElement("div",{className:"col-md-6 col-sm-12 mx-auto my-5 border "},c.a.createElement("div",{className:" border rounded text-center mt-5 chat_name pt-2 text-capitalize"},t.authenticated?c.a.createElement(c.a.Fragment,null," hello, ","".concat(t.firstName," ").concat(t.lastName)):null),c.a.createElement("div",{className:"text-capitalize"},a.users.length>0?c.a.createElement(y.a,Object.assign({className:"slider-items owl-carousel "},{responsiveClass:!0,autoplay:!0,smartSpeed:1e3,responsive:{0:{items:2},400:{items:2},600:{items:2},700:{items:2},1e3:{items:2}}}),a.users.map((function(e){return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{class:"card",style:{}},c.a.createElement("div",{class:"card-body bg-info"},c.a.createElement(k,{user:e,key:e.uid,onClick:x}))))}))," "):null),s?c.a.createElement("div",{id:"head",className:"mt-3 text-capitalize px-3 py-2"}," ",c.a.createElement(S.a,{size:"50",round:!0,name:b,className:"mr-3"}),b,a.isOnline?c.a.createElement("span",{className:"float-right my-3 online"},"  "):c.a.createElement("span",{className:"float-right my-3 offline"},"  ")):c.a.createElement(c.a.Fragment,null," ",c.a.createElement("h1",{className:"my-5 maker  "},"Select User From Above to chat ",c.a.createElement(U.a,null))," ",c.a.createElement("br",null),c.a.createElement("h2",{className:"my-5 text-center maker "},"Developed By:",c.a.createElement("b",{style:{color:"black"}},c.a.createElement("u",null," Abdul Aabid Khan")))),c.a.createElement("div",{id:"body",className:"mb-0"},s?c.a.createElement("div",{className:"bg-info w-100 h-100"},a.conversations.map((function(e){return c.a.createElement("div",{style:{textAlign:e.user_uid_1==t.uid?"right":"left"}},c.a.createElement("p",{className:"px-2"},e.message))}))," "):"",c.a.createElement("div",{id:"btm"},s?c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{class:"input-group mb-3"},c.a.createElement("input",{type:"text",class:"form-control",placeholder:"Write Your Message....","aria-label":"Recipient's username","aria-describedby":"button-addon2",value:j,onChange:function(e){return N(e.target.value)}}),c.a.createElement("div",{class:"input-group-append"},c.a.createElement("button",{class:"btn btn-info",type:"button",id:"button-addon2"},c.a.createElement(_.a,{onClick:function(){var a={message:j,user_uid_1:t.uid,user_uid_2:I};console.log(a),""!=j&&(e(function(e){return function(){var t=Object(d.a)(m.a.mark((function t(a){return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:Object(p.firestore)().collection("conversations").add(Object(v.a)(Object(v.a)({},e),{},{createdAt:new Date,isView:!1})).then((function(e){console.log(e)})).catch((function(e){console.log(e),alert(e)}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(a)),N(""))}}))))):null)))))},I=(a(231),function(){var e=Object(r.useState)(),t=Object(g.a)(e,2),a=t[0],n=t[1],l=Object(r.useState)(),s=Object(g.a)(l,2),u=s[0],i=s[1],f=Object(r.useState)(),b=Object(g.a)(f,2),E=b[0],h=b[1],v=Object(r.useState)(),S=Object(g.a)(v,2),j=S[0],y=S[1],N=Object(o.b)();return Object(o.c)((function(e){return e.auth})).authenticated?c.a.createElement(O.a,{to:"/"}):c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{class:"signup"},c.a.createElement("form",{onSubmit:function(e){e.preventDefault(),N(function(e){return function(){var t=Object(d.a)(m.a.mark((function t(a){var n;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=Object(p.firestore)(),a({type:"LOGIN_REQUEST"}),Object(p.auth)().createUserWithEmailAndPassword(e.email,e.password).then((function(t){console.log(t);var r=Object(p.auth)().currentUser,c="".concat(e.fname," ").concat(e.lname);r.updateProfile({displayName:c}).then((function(){n.collection("users").doc(t.user.uid).set({firstName:e.fname,lastName:e.lname,uid:t.user.uid,createdAt:new Date,isOnline:!0}).then((function(){var n={firstName:e.fname,lastName:e.lname,uid:t.user.uid,email:e.email};localStorage.setItem("user",JSON.stringify(n)),console.log("successfull"),a({type:"LOGIN_SUCCESS",payload:{user:n}})})).catch((function(e){console.log(e),a({type:"LOGIN_FAIL",payload:{error:e}})}))}))})).catch((function(e){console.log(e),alert(e)}));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}({fname:a,lname:u,email:E,password:j}))}},c.a.createElement("label",{className:"label1",for:"chk","aria-hidden":"true"},"Sign up"),c.a.createElement("input",{className:"input1",type:"text",name:"txt",placeholder:"First Name",required:"",value:a,onChange:function(e){return n(e.target.value)}}),c.a.createElement("input",{className:"input1",type:"text",name:"txtl",placeholder:"Last Name",required:"",value:u,onChange:function(e){return i(e.target.value)}}),c.a.createElement("input",{className:"input1",type:"email",name:"email",placeholder:"Email",required:"",value:E,onChange:function(e){return h(e.target.value)}}),c.a.createElement("input",{className:"input1",type:"password",name:"pswd",placeholder:"Password",required:"",value:j,onChange:function(e){return y(e.target.value)}}),c.a.createElement("button",{className:"button1",type:"submit"},"Sign up"))))}),L=function(){var e=Object(r.useState)(""),t=Object(g.a)(e,2),a=t[0],n=t[1],l=Object(r.useState)(""),s=Object(g.a)(l,2),u=s[0],i=s[1],f=Object(o.b)(),b=Object(o.c)((function(e){return e.auth}));console.log(b.t);return b.authenticated?c.a.createElement(O.a,{to:"/"}):c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"body1 mt-4"},c.a.createElement("div",{class:"main"},c.a.createElement("input",{type:"checkbox",id:"chk","aria-hidden":"true"}),c.a.createElement(I,null),c.a.createElement("div",{class:"login"},c.a.createElement("form",{onSubmit:function(e){var t;(e.preventDefault(),""!=a)?""!=u?f((t={email:a,password:u},function(){var e=Object(d.a)(m.a.mark((function e(a){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a({type:"LOGIN_REQUEST"}),Object(p.auth)().signInWithEmailAndPassword(t.email,t.password).then((function(e){console.log(e),Object(p.firestore)().collection("users").doc(e.user.uid).update({isOnline:!0}).then((function(){var t=e.user.displayName.split(" "),n={firstName:t[0],lastName:t[1],uid:e.user.uid,email:e.user.email};localStorage.setItem("user",JSON.stringify(n)),console.log("successfull"),a({type:"LOGIN_SUCCESS",payload:{user:n}})})).catch((function(e){alert(e)}))})).catch((function(e){alert(e),a({type:"LOGIN_FAIL",payload:{error:e}})}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())):alert("paas required"):alert("email required")}},c.a.createElement("label",{className:"label1",for:"chk","aria-hidden":"true"},"Login"),c.a.createElement("input",{className:"input1",type:"email",name:"email",placeholder:"Email",required:"",value:a,onChange:function(e){return n(e.target.value)}}),c.a.createElement("input",{className:"input1",type:"password",name:"pswd",placeholder:"Password",required:"",value:u,onChange:function(e){return i(e.target.value)}}),c.a.createElement("button",{className:"button1",type:"submit"},"Login"))))))},x=a(157),A=function(e){var t=e.component,a=Object(x.a)(e,["component"]);return c.a.createElement(c.a.Fragment,null,c.a.createElement(O.b,Object.assign({},a,{component:function(e){return(localStorage.getItem("user")?JSON.parse(localStorage.getItem("user")):null)?c.a.createElement(t,e):c.a.createElement(O.a,{to:"/login"})}})))},F=function(){var e=Object(o.b)(),t=Object(o.c)((function(e){return e.auth}));return Object(r.useEffect)((function(){t.authenticated||e(function(){var e=Object(d.a)(m.a.mark((function e(t){var a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=localStorage.getItem("user")?JSON.parse(localStorage.getItem("user")):null,t(a?{type:"LOGIN_SUCCESS",payload:{user:a}}:{type:"LOGIN_FAIL",payload:{error:"Log In Again Please"}});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[]),c.a.createElement(c.a.Fragment,null,c.a.createElement(h,null),c.a.createElement(O.d,null,c.a.createElement(A,{exact:!0,path:"/",component:C}),c.a.createElement(O.b,{exact:!0,path:"/login",component:L}),c.a.createElement(O.a,{to:"/"})))},G=a(39),R=a(156),T=a(55),D=(n={firstName:"",lastName:"",email:"",authenticated:!1},Object(T.a)(n,"authenticated",!1),Object(T.a)(n,"error",null),n),q={users:[],conversations:[]},J=Object(G.c)({auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D,t=arguments.length>1?arguments[1]:void 0;switch(console.log(t),t.type){case"LOGIN_REQUEST":e=Object(v.a)(Object(v.a)({},e),{},{authenticating:!0});break;case"LOGIN_SUCCESS":e=Object(v.a)(Object(v.a)(Object(v.a)({},e),t.payload.user),{},{authenticating:!1,authenticated:!0});break;case"LOGIN_FAIL":e=Object(v.a)(Object(v.a)(Object(v.a)({},e),t.payload.error),{},{authenticating:!1,authenticated:!1});break;case"USER_LOGOUT_REQUEST":break;case"USER_LOGOUT_SUCCESS":e=Object(v.a)({},D);break;case"USER_LOGOUT_FAIL":e=Object(v.a)(Object(v.a)({},e),{},{error:t.payload.error})}return e},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:q,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"USER_REQUEST":break;case"USER_SUCCESS":e=Object(v.a)(Object(v.a)({},e),{},{users:t.payload.users});break;case"MESSAGE_SENT_SUCCESS":e=Object(v.a)(Object(v.a)({},e),{},{conversations:t.payload.conversations})}return e}}),Q=Object(G.d)(J,Object(G.a)(R.a));f.a.initializeApp({apiKey:"AIzaSyB-WIh9WISJXxjuHDcDBt06F0DSeKA1HQM",authDomain:"amessenger-87721.firebaseapp.com",databaseURL:"https://amessenger-87721.firebaseio.com",projectId:"amessenger-87721",storageBucket:"amessenger-87721.appspot.com",messagingSenderId:"132305837693",appId:"1:132305837693:web:6ed138f8265081ced85b14",measurementId:"G-J4LMW29S1G"}),window.store=Q,s.a.render(c.a.createElement(o.a,{store:Q},c.a.createElement(u.a,null,c.a.createElement(F,null))),document.getElementById("root"))}},[[159,1,2]]]);
//# sourceMappingURL=main.60dfa168.chunk.js.map